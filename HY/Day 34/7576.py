"""
í† ë§ˆí†  ê³¨ë“œ 5
"""
import sys
from collections import deque ##bfsë¥¼ ì‚¬ìš©í•  ë• dequeë¥¼ ì‚¬ìš©í•˜ì
input = sys.stdin.readline

m,n = map(int, input().split())
box = []
for i in range(n):
    box.append(list(map(int, input().split())))

#ìƒí•˜ì¢Œìš° ë°©í–¥
dx = [-1, 1, 0, 0]
dy = [0, 0, -1, 1]

""" íì— 1ì¸ í† ë§ˆí† ê°’ì„ ì´ˆê¸°í™”
ğŸŒŸğŸŒŸğŸŒŸì¶œë°œì ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš° ì¶œë°œì ì„ ëª¨~ë‘ Queueì— ë¯¸ë¦¬ ë„£ì–´ì•¼ í•œë‹¤.ğŸŒŸğŸŒŸğŸŒŸ
ì‹œì‘ì  ìµì€ í† ë§ˆí† (1)ì¸ í† ë§ˆí†  ìœ„ì¹˜ íì— append
 1 -1 0 0 0 0
 0 -1 0 0 0 0
 0 0 0 0 -1 0     íì— 1ì¸ í† ë§ˆí† ë“¤ì˜ ìœ„ì¹˜ê°€ ì…ë ¥ëœë‹¤
 0 0 0 0 -1 1      deque([(0, 0), (3, 5)])
"""
q = deque([])
for i in range(n):
    for j in range(m):
        if box[i][j] == 1: #1ì¸ ê°’ë“¤ì´ qì— ë“¤ì–´ê°
            q.append([i, j])

def bfs():
     while q:
         x, y = q.popleft() #ìµì€ í† ë§ˆí† ë“¤ì˜ ìœ„ì¹˜ë¥¼ êº¼ëƒ„
         for i in range(4):  # í˜„ì¬ ìœ„ì¹˜ì—ì„œ ìƒí•˜ì¢Œìš° í™•ì¸
             nextX = x + dx[i]  # ìƒˆë¡œ ì´ë™í•  ìœ„ì¹˜
             nextY = y + dy[i]
             # ë²”ìœ„ í™•ì¸: ë²”ìœ„ ì•ˆì— ìˆê³ , í† ë§ˆí†  ìƒíƒœê°€ 0ì¸ ê²½ìš°
             if 0 <= nextX < n and 0 <= nextY < m and box[nextX][nextY] == 0:
                box[nextX][nextY] = box[x][y] + 1 #ê¸°ì¡´ í† ë§ˆí† ê°’ +1 ë°•ìŠ¤ì— ë„£ìŒ
                q.append([nextX, nextY]) #qì— í† ë§ˆí†  ìœ„ì¹˜ë¥¼ ë„£ì–´ì¤Œ
bfs()
answer = 0
# forë¬¸ìœ¼ë¡œ ë°•ìŠ¤ ì•ˆì— í† ë§ˆí† ë“¤ì„ í™•ì¸í•œë‹¤. 
#box = [[1, -1, 7, 6, 5, 4], 
#       [2, -1, 6, 5, 4, 3],  
#       [3, 4, 5, 6, -1, 2], 
#       [4, 5, 6, 7, -1, 1]]  
# ë§Œì•½ 0ì¸ ê°’ì´ ìˆë‹¤ë©´ ìµíˆì§€ ëª»í•˜ëŠ” í† ë§ˆí† ì´ë¯€ë¡œ -1ë¥¼ ì¶œë ¥í•œ í›„ ì¢…ë£Œí•œë‹¤.
for line in box:
     for tomato in line:
         if tomato == 0:# ì•ˆìµì€ í† ë§ˆí† (0)ì´ ìˆìœ¼ë©´ -1 ì¶œë ¥ í›„ë°”ë¡œ ì¢…ë£Œ
             print(-1)
             exit(0)
     answer = max(answer, max(line)) #ë°•ìŠ¤ ì•ˆì—ì„œ ë‹¤ ìµì—ˆìœ¼ë©´ ìµœëŒ“ê°’ì´ ì •ë‹µ
print(answer-1) #ì²˜ìŒ ìµì€ í† ë§ˆí†  1ì—ì„œ ì‹œì‘í–ˆê¸° ë•Œë¬¸ì— -1